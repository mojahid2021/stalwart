â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  SECURITY AUDIT REPORT - STALWART MAIL SERVER                â•‘
â•‘                         Comprehensive Analysis Complete                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… Audit Date: February 10, 2026
ğŸ¯ Overall Rating: B+ (Good, with Critical Issues to Address)
ğŸ“Š Total Vulnerabilities Found: 11

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                          VULNERABILITY BREAKDOWN                             â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

ğŸ”´ CRITICAL (1)    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ CVSS 9.8
   â””â”€ Command Execution in Sieve Scripts
      Location: crates/common/src/scripts/plugins/exec.rs
      Impact: Complete system compromise possible

ğŸŸ  HIGH (3)        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ CVSS 6.5-7.4
   â”œâ”€ Weak Cryptographic Hash Support (MD5/SHA-1)
   â”œâ”€ Extensive panic!/unwrap() Usage (DoS Risk)
   â””â”€ Limited File Path Validation (Traversal Risk)

ğŸŸ¡ MEDIUM (4)      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ CVSS 5.3-5.9
   â”œâ”€ SQL Injection Risk (Dynamic Queries)
   â”œâ”€ Unsafe Code Usage (7 instances)
   â”œâ”€ Environment Variable Injection
   â””â”€ Docker Security Configuration

ğŸŸ¢ LOW (3)         â–ˆâ–ˆâ–ˆâ–ˆ CVSS 3.1-3.7
   â”œâ”€ Information Disclosure in Errors
   â”œâ”€ Timing Attack Vulnerabilities
   â””â”€ Missing Security Headers

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                          SECURITY STRENGTHS                                  â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

âœ… Memory Safety              - Rust prevents buffer overflows & memory corruption
âœ… Modern Cryptography         - Argon2, bcrypt, PBKDF2, scrypt support
âœ… Strong Authentication       - 2FA (TOTP), OAuth 2.0, LDAP, RBAC
âœ… No Hardcoded Secrets        - Environment variables used throughout
âœ… Parameterized SQL Queries   - Protection against SQL injection
âœ… Comprehensive Documentation - SECURITY.md with disclosure policy

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                          IMMEDIATE ACTIONS REQUIRED                          â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

ğŸš¨ DAY 1 (Critical)
   [ ] Disable exec() function in Sieve scripts by default
   [ ] Add configuration flag with security warnings
   [ ] Update Docker to run as non-root user
   [ ] Document command execution security risks

ğŸ“‹ WEEK 1 (High Priority)
   [ ] Implement weak hash deprecation warnings
   [ ] Add path canonicalization for file operations
   [ ] Audit all unsafe code blocks
   [ ] Implement command whitelist for exec()

ğŸ”§ MONTH 1 (High Priority)
   [ ] Automatic password rehashing on login
   [ ] Reduce panic!/unwrap() in critical paths
   [ ] Add comprehensive security tests
   [ ] Implement Docker security profiles

ğŸ“… MONTH 2-3 (Medium Priority)
   [ ] Integrate secrets management system
   [ ] Enhanced monitoring and alerting
   [ ] Add security headers to web interfaces
   [ ] Conduct penetration testing

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                          DOCUMENTATION STRUCTURE                             â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

ğŸ“„ SECURITY_AUDIT_INDEX.md      â† Start here (navigation guide)
   â”œâ”€â”€ Quick start by role
   â”œâ”€â”€ Critical alerts
   â””â”€â”€ Links to all documentation

ğŸ“Š SECURITY_AUDIT_SUMMARY.md    â† Quick reference (241 lines)
   â”œâ”€â”€ Executive summary
   â”œâ”€â”€ Vulnerability breakdown
   â”œâ”€â”€ Quick fixes
   â””â”€â”€ Action plan with timelines

ğŸ“– SECURITY_AUDIT_REPORT.md     â† Full analysis (673 lines)
   â”œâ”€â”€ Detailed vulnerability descriptions
   â”œâ”€â”€ CVSS scores and impact assessments
   â”œâ”€â”€ Code examples and attack scenarios
   â”œâ”€â”€ Remediation steps
   â”œâ”€â”€ OWASP Top 10 compliance
   â””â”€â”€ CWE coverage analysis

ğŸ” SECURITY.md                   â† Official security policy
   â”œâ”€â”€ Vulnerability disclosure
   â”œâ”€â”€ Supported versions
   â””â”€â”€ Contact information

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                          OWASP TOP 10 (2021) ANALYSIS                        â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

A01: Broken Access Control       âœ… GOOD    - RBAC implemented
A02: Cryptographic Failures       âš ï¸  FAIR    - Weak hashes present
A03: Injection                    âš ï¸  FAIR    - Command injection risk
A04: Insecure Design              âœ… GOOD    - Well-designed
A05: Security Misconfiguration    âš ï¸  FAIR    - Docker runs as root
A06: Vulnerable Components        âœ… GOOD    - Well-maintained
A07: Auth & Session               âœ… GOOD    - Strong authentication
A08: Software & Data Integrity    âœ… GOOD    - Rust type safety
A09: Logging & Monitoring         âœ… GOOD    - Comprehensive logging
A10: SSRF                         âœ… GOOD    - Limited external requests

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                          CODEBASE METRICS                                    â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

ğŸ“Š Lines of Code:           ~200,000+ (Rust)
ğŸ”“ Unsafe Blocks:           7 (0.0035% of codebase)
ğŸ“¦ Dependencies:            Well-maintained, regularly updated
âœ… Test Coverage:           Comprehensive test suite present
ğŸ“š Documentation:           Extensive security documentation
ğŸ”’ Memory Safety:           99.9965% safe code

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                          CONTACT & REPORTING                                 â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

ğŸ”’ Security Issues:          security@stalw.art
ğŸ’¬ General Questions:        hello@stalw.art
ğŸ“˜ Documentation:            https://stalw.art/docs
ğŸ› Bug Reports:              https://github.com/stalwartlabs/stalwart/issues

âš ï¸  DO NOT report security vulnerabilities through public GitHub issues!

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                          NEXT STEPS                                          â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

1. ğŸ“– Read SECURITY_AUDIT_SUMMARY.md for quick overview
2. ğŸ” Review SECURITY_AUDIT_REPORT.md for technical details
3. ğŸš¨ Address critical command execution vulnerability immediately
4. ğŸ“‹ Follow the action plan to address all findings
5. âœ… Use verification checklist to track progress
6. ğŸ”„ Schedule next security audit for May 10, 2026

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  Report Generated: February 10, 2026                         â•‘
â•‘                  Version: 1.0 | Next Review: May 10, 2026                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
